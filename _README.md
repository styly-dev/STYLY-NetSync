# STYLY NetSync for LBE
A Unity networking module and server for XR-powered Location Based Entertainment

[![version](https://img.shields.io/github/v/release/styly-dev/STYLY-NetSync?include_prereleases)](https://github.com/styly-dev/STYLY-NetSync/releases)
[![Unity 6](https://img.shields.io/badge/Unity%206.x-supported-blue)](https://unity.com/releases/unity-6)
[![License](https://img.shields.io/badge/License-Apache_2.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
[![DeepWiki](_images/Icons/DeepWiki-styly-dev_STYLY-NetSync-blue.svg)](https://deepwiki.com/styly-dev/STYLY-NetSync) <!-- DeepWiki badge generated by https://deepwiki.ryoppippi.com/ -->



<img width="600" height="228" alt="STYLY-NetSync_1200" src="_images/STYLY-NetSync_logo.png" />


## Overview

A minimal, high-performance networking package for Unity — built specifically for location-based entertainment (LBE) experiences.
STYLY NetSync includes an easy-to-integrate Unity package and a lightweight Python server to make real-time, synchronized XR sessions easy to build and deploy in venue networks.

**Highlights**

- **Super easy to use** — simple API and drop-in package so you can integrate fast and get running with minimal setup.
- **Super lightweight** — low CPU / memory footprint; optimized network traffic for stable performance on local networks.
- **Optimized for LBE** — syncs virtual and physical transforms and offers Human Presence (collision avoidance).

## Features

### Main features
- Avatar Transform Synchronization
- RPC (Remote Procedure Call) 
- Network Variable

### Other features
- One-click SDK setup for HMDs
- Multifunctional XR Rig
- Battery level management

Some features are provided via dependent package STYLY XR Rig.

## Installation

### Prerequisites

uv/uvx: Required to start the server.  
OpenUPM: Required only when you add the package to your Unity project.  

```shell
# Windows
winget install -e --id OpenJS.NodeJS.LTS
winget install --id=astral-sh.uv  -e
npm install -g openupm-cli

# Mac
brew install node
brew install uv
npm install -g openupm-cli
```

### Add STYLY-NetSync to Unity project

```shell
# Go to your unity project directory
cd YOUR_UNITY_PROJECT_DIR

# Add NetSync package with specific version
openupm add -f com.styly.styly-netsync@0.5.7
```

## Setup

### Start NetSync server


```shell
# Start NetSync server
# Use the same version of the Unity package
uvx styly-netsync-server@0.5.7
```
The uvx command automatically downloads the package, creates an isolated virtual environment, installs dependencies, and runs the python server program.


### Setup Unity scene

| SDK setup for HMDs | STYLY XR Rig |
|---|---|
| ![Setup SDK](_images/Screenshots/Setup_SDK.png)<br>Downloads and installs SDK, and sets up configurations. See more [details](https://github.com/styly-dev/STYLY-XR-Rig/blob/develop/Packages/com.styly.styly-xr-rig/Editor/SetupSDK/README.md). | ![STYLY XR Rig](_images/Screenshots/Add_STYLY_XR_Rig.png)<br>Supports most of samples in XR Interaction Toolkit, MR mode of HMDs, WASD control in Unity Editor mode and stick locomotion with HMD controllers.  |


#### NetSync Manager

<table>
  <thead>
    <tr>
      <th align="left">Inspector</th>
      <th align="left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td align="left" valign="top">
        <img src="_images/Screenshots/NetSyncManager_Properties.png">
      </td>
      <td align="left" valign="top">

<strong>Properties</strong>
- _deviceId - Displays the unique device ID assigned to this client.
- _clientNo - Shows the numeric client number assigned by the server.
- _serverAddress - Server IP or hostname; leave empty to auto-discover on the local network.
- _roomId - Identifier of the current room to join.
- _localAvatarPrefab - Prefab used for the local user’s avatar.
- _remoteAvatarPrefab - Prefab used for remote users’avatars.
- _humanPresencePrefab - Prefab shown at each remote user’s physical position (used for “human presence” visualization).
      </td>
    </tr>
    <tr>
      <td align="left" valign="top">
        <img src="_images/Screenshots/NetSyncManager_UnityEvents.png">
      </td>
      <td align="left" valign="top">

<strong>Events</strong>
- OnAvatarConnected - Triggered when a remote avatar connects to the network, passing the client number as an argument.
- OnAvatarDisconnected - Triggered when a remote avatar disconnects from the network, passing the client number as an argument.
- OnRPCReceived - Triggered when a Remote Procedure Call (RPC) is received from another client, passing the sender's client number, function name and arguments.
- OnGlobalVariableChanged - Triggered when a global network variable is changed by another client, passing the variable name, old value and new value.
- OnClientVariableChanged - Triggered when a client-specific network variable is changed by another client, passing the target client number, variable name, old value and new value.
- OnReady - Triggered when the NetSyncManager is fully ready and connected to the server with handshake completed and network variables synchronized.
      </td>
    </tr>
  </tbody>
</table>


## Unity C# API Reference

### Namespace Import
```csharp
// Import STYLY NetSync
using Styly.NetSync;
```


### RPC
```csharp
// Broadcast to all clients in the room
NetSyncManager.Instance.Rpc("FunctionName", new string[] { "arg1", "arg2" });

// Receive RPCs
NetSyncManager.Instance.OnRPCReceived.AddListener((senderClientNo, functionName, args) =>
{
    Debug.Log($"RPC(senderClientNo): {senderClientNo}");
    Debug.Log($"RPC(functionName): {functionName}");
    foreach (var arg in args) Debug.Log($"RPC(args): {arg}");
});
```

### Network Variable
```csharp
// Set global variable (shared across all clients in room)
NetSyncManager.Instance.SetGlobalVariable("gameState", "playing");

// Set client-specific variable (set your own)
NetSyncManager.Instance.SetClientVariable("playerScore", "100");

// Set another client's variable (requires their client number)
NetSyncManager.Instance.SetClientVariable(targetClientNo, "health", "50");

// Get variables
string gameState = NetSyncManager.Instance.GetGlobalVariable("gameState");
string score = NetSyncManager.Instance.GetClientVariable(clientNo, "playerScore");

// Get variables with default value
string gameState = NetSyncManager.Instance.GetGlobalVariable("gameState", "Initial State");

// Listen for value changes
NetSyncManager.Instance.OnGlobalVariableChanged.AddListener((name, oldVal, newVal) => {
    Debug.Log($"Global var {name} changed: {oldVal} -> {newVal}");
});

NetSyncManager.Instance.OnClientVariableChanged.AddListener((clientNo, name, oldVal, newVal) => {
    Debug.Log($"Client {clientNo} var {name} changed: {oldVal} -> {newVal}");
});

```


## Transport layer
STYLY NetSync uses [ZeroMQ](https://zeromq.org/) as its transport layer  
– C# (Unity): [NetMQ](https://github.com/zeromq/netmq)  
– Python (server): [pyzmq](https://github.com/zeromq/pyzmq)  

## License
This repository contains multiple sub-projects, each with its own license file. All sub-projects are licensed under the Apache License, Version 2.0.
